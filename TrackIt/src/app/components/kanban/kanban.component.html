<div class="layout-container">
  <!-- Feladat hozz√°ad√°s√°ra szolg√°l√≥ ≈±rlap -->
  <div class="todo-creator">
    <h2>ToDo</h2>

    <label>Feladat:</label>
    <input type="text" [(ngModel)]="newTask.title" placeholder="Feladat c√≠me">

    <label>Le√≠r√°s:</label>
    <textarea id="descriptionArea" [(ngModel)]="newTask.description" style="resize: vertical; min-height: 10%;" placeholder="Feladat le√≠r√°sa"></textarea>

    <label>Hat√°rid≈ë:</label>
    <input type="date" [(ngModel)]="newTask.dueDate" (change)="onDateChange($event)">

    <label>Priorit√°s:</label>
    <div class="priority-buttons">
      <button class="low" (click)="setPriority('Alacsony')" [class.active]="newTask.priority === 'Alacsony'">Alacsony</button>
      <button class="medium" (click)="setPriority('K√∂zepes')" [class.active]="newTask.priority === 'K√∂zepes'">K√∂zepes</button>
      <button class="high" (click)="setPriority('Magas')" [class.active]="newTask.priority === 'Magas'">Magas</button>
    </div>

    <button class="get-started-button" (click)="addTask()">Feladat hozz√°ad√°sa</button>
  </div>

  <!-- Kanban t√°bla -->
  <div class="kanban-board">
    <div class="kanban-column" *ngFor="let column of columns" (dragover)="onDragOver($event)" (drop)="onDrop($event, column)">
      
      <div class="kanban-column-header">
        <h3>{{ column.name }}</h3>
        <div class="task-count">{{ column.tasks.length }} feladat</div>
      </div>

      <div class="kanban-tasks" (drop)="onDrop($event, column)" (dragover)="onDragOver($event)" (dragenter)="onDragEnter($event)">
        <div *ngFor="let task of column.tasks" 
             class="kanban-task" 
             draggable="true" 
             (dragstart)="onDragStart($event, task, column)">
          
          <div class="task-header">
            <h4><strong>C√≠m:</strong> {{ task.title }}</h4>
            <div class="task-menu-container">
              <button class="menu-button" (click)="toggleTaskMenu(task)">&#8942;</button>
              <div class="menu-options" *ngIf="task.showMenu">
                <button class="menu-item edit" (click)="editTask(task)">‚úèÔ∏è Feladat m√≥dos√≠t√°sa</button>
                <button class="menu-item delete" (click)="deleteTask(task, column)">üóëÔ∏è Feladat t√∂rl√©se</button>
              </div>
            </div>
          </div>
          
          <p><strong>Le√≠r√°s:</strong> {{ task.description }}</p>
          <p><strong>Hat√°rid≈ë:</strong> {{ task.dueDate | date:'yyyy. MM. dd.' }}</p>
          
          <p *ngIf="task.priority">
            <span class="priority-box" [ngClass]="getPriorityClass(task.priority)"></span>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Popup szerkeszt≈ë ablak -->
  <app-task-edit 
    *ngIf="selectedTask" 
    [task]="selectedTask" 
    (closePopup)="selectedTask = null" 
    (taskUpdated)="onTaskUpdated($event)">
  </app-task-edit>

  <!-- Popup meger≈ës√≠t≈ë ablak -->
  <div class="popup-container" *ngIf="showPopup">
    <div class="popup">
      <p>{{ popupMessage }}</p>
      <button class="confirm-button" (click)="confirmTaskMove()">Igen</button>
      <button class="cancel-button" (click)="cancelTaskMove()">M√©gse</button>
    </div>
  </div>
  
</div>

<app-alert-modal 
  [visible]="isModalVisible" 
  [type]="'warning'"
  [message]="'Biztosan folytatni szeretn√©d?'"
  [invalidFields]="['N√©v', 'Email c√≠m']"
  [buttons]="[
    { label: 'Igen', action: confirmTaskMove, class: 'cancel-btn' },
    { label: 'Nem', action: cancelTaskMove, class: 'confirm-btn' }
  ]"
  (close)="isModalVisible = false">
</app-alert-modal>